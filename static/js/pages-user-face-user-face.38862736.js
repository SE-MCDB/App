(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-face-user-face"],{"268a":function(t,e,a){"use strict";a.r(e);var o=a("535a"),i=a("4036");for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("2874");var r,c=a("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"75fd921c",null,!1,o["a"],r);e["default"]=s.exports},2874:function(t,e,a){"use strict";var o=a("a471"),i=a.n(o);i.a},"38ab":function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,'/* pages/uni-cropper/index.wxss */.uni-content-info[data-v-75fd921c]{\n\t\t/* position: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tdisplay: block;\n\t\talign-items: center;\n\t\tflex-direction: column; */}.cropper-config[data-v-75fd921c]{padding:%?20?% %?40?%}.cropper-content[data-v-75fd921c]{min-height:%?750?%;width:100%}.uni-corpper[data-v-75fd921c]{position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;box-sizing:border-box}.uni-corpper-content[data-v-75fd921c]{position:relative}.uni-corpper-content uni-image[data-v-75fd921c]{display:block;width:100%;min-width:0!important;max-width:none!important;height:100%;min-height:0!important;max-height:none!important;image-orientation:0deg!important;margin:0 auto}\n\n\t/* 移动图片效果 */.uni-cropper-drag-box[data-v-75fd921c]{position:absolute;top:0;right:0;bottom:0;left:0;cursor:move;background:rgba(0,0,0,.6);z-index:1}\n\n\t/* 内部的信息 */.uni-corpper-crop-box[data-v-75fd921c]{position:absolute;background:hsla(0,0%,100%,.3);z-index:2}.uni-corpper-crop-box .uni-cropper-view-box[data-v-75fd921c]{position:relative;display:block;width:100%;height:100%;overflow:visible;outline:%?1?% solid #69f;outline-color:rgba(102,153,255,.75)}\n\n\t/* 横向虚线 */.uni-cropper-dashed-h[data-v-75fd921c]{position:absolute;top:33.33333333%;left:0;width:100%;height:33.33333333%;border-top:%?1?% dashed hsla(0,0%,100%,.5);border-bottom:%?1?% dashed hsla(0,0%,100%,.5)}\n\n\t/* 纵向虚线 */.uni-cropper-dashed-v[data-v-75fd921c]{position:absolute;left:33.33333333%;top:0;width:33.33333333%;height:100%;border-left:%?1?% dashed hsla(0,0%,100%,.5);border-right:%?1?% dashed hsla(0,0%,100%,.5)}\n\n\t/* 四个方向的线  为了之后的拖动事件*/.uni-cropper-line-t[data-v-75fd921c]{position:absolute;display:block;width:100%;background-color:#69f;top:0;left:0;height:%?1?%;opacity:.1;cursor:n-resize}.uni-cropper-line-t[data-v-75fd921c]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-r[data-v-75fd921c]{position:absolute;display:block;background-color:#69f;top:0;right:%?0?%;width:%?1?%;opacity:.1;height:100%;cursor:e-resize}.uni-cropper-line-r[data-v-75fd921c]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-line-b[data-v-75fd921c]{position:absolute;display:block;width:100%;background-color:#69f;bottom:0;left:0;height:%?1?%;opacity:.1;cursor:s-resize}.uni-cropper-line-b[data-v-75fd921c]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-l[data-v-75fd921c]{position:absolute;display:block;background-color:#69f;top:0;left:0;width:%?1?%;opacity:.1;height:100%;cursor:w-resize}.uni-cropper-line-l[data-v-75fd921c]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-point[data-v-75fd921c]{width:%?5?%;height:%?5?%;background-color:#69f;opacity:.75;position:absolute;z-index:3}.point-t[data-v-75fd921c]{top:%?-3?%;left:50%;margin-left:%?-3?%;cursor:n-resize}.point-tr[data-v-75fd921c]{top:%?-3?%;left:100%;margin-left:%?-3?%;cursor:n-resize}.point-r[data-v-75fd921c]{top:50%;left:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-rb[data-v-75fd921c]{left:100%;top:100%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);cursor:n-resize;width:%?36?%;height:%?36?%;background-color:#69f;position:absolute;z-index:1112;opacity:1}.point-b[data-v-75fd921c]{left:50%;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-bl[data-v-75fd921c]{left:0;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-l[data-v-75fd921c]{left:0;top:50%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-lt[data-v-75fd921c]{left:0;top:0;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}\n\n\t/* 裁剪框预览内容 */.uni-cropper-viewer[data-v-75fd921c]{position:relative;width:100%;height:100%;overflow:hidden}.uni-cropper-viewer uni-image[data-v-75fd921c]{position:absolute;z-index:2}\n\n\t/* 以下是我的补充css */\n\n\t/* 页面铺满屏幕 */.page-fill[data-v-75fd921c]{width:100%;height:100%;position:absolute;background:#000}.myDistance[data-v-75fd921c]{\n\t\t/* padding-top: 100upx */}\n\n\t/* 底部操作 start */.footer-opertor[data-v-75fd921c]{position:fixed;bottom:0;border-top:#515050 solid 1px;width:100%;display:flex;flex-direction:row;justify-content:space-between;padding:%?30?%}.opertor-words[data-v-75fd921c]{color:#e8e5e5;font-size:16px;width:%?200?%}\n\n\t/* 底部操作 end */',""]),t.exports=e},4036:function(t,e,a){"use strict";a.r(e);var o=a("d4f3"),i=a.n(o);for(var n in o)"default"!==n&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=i.a},"535a":function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page page-fill"},[a("v-uni-view",{staticClass:"page-body uni-content-info"},[a("v-uni-view",{staticClass:"cropper-content"},[t.isShowImg?a("v-uni-view",{staticClass:"uni-corpper myDistance",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000"},[a("v-uni-view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px"},[a("v-uni-image",{staticClass:"myImage",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc}}),a("v-uni-view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.contentStartMove.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.contentMoveing.apply(void 0,arguments)},touchend:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.contentTouchEnd.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-cropper-view-box"},[a("v-uni-view",{staticClass:"uni-cropper-dashed-h"}),a("v-uni-view",{staticClass:"uni-cropper-dashed-v"}),a("v-uni-view",{staticClass:"uni-cropper-line-t",attrs:{"data-drag":"top"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-r",attrs:{"data-drag":"right"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-l",attrs:{"data-drag":"left"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-t",attrs:{"data-drag":"top"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-tr",attrs:{"data-drag":"topTight"}}),a("v-uni-view",{staticClass:"uni-cropper-point point-r",attrs:{"data-drag":"right"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)},touchend:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragEnd.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-bl",attrs:{"data-drag":"bottomLeft"}}),a("v-uni-view",{staticClass:"uni-cropper-point point-l",attrs:{"data-drag":"left"},on:{touchstart:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragStart.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-lt",attrs:{"data-drag":"leftTop"}})],1)],1)],1)],1):t._e()],1),a("v-uni-view",{staticClass:"footer-opertor"},[a("v-uni-view",{staticClass:"opertor-words",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getImage.apply(void 0,arguments)}}},[t._v("重新选择")]),a("v-uni-view",{staticClass:"opertor-words",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getImageInfo.apply(void 0,arguments)}}},[t._v("确认上传")])],1),a("v-uni-canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})],1)],1)},n=[]},"63af":function(t,e,a){"use strict";var o=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.uploudFile=void 0,a("96cf");var i=o(a("1da1")),n=o(a("4622")),r=(a("13b4"),function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return{"Content-Type":"multipart/form-data"},t.next=3,n.default.post("user/icon",e);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());e.uploudFile=r},a471:function(t,e,a){var o=a("38ab");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("9680d4c0",o,!0,{sourceMap:!1,shadowMode:!1})},d4f3:function(t,e,a){"use strict";var o=a("4ea4");a("4160"),a("b64b"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i,n,r,c,s,p,u,d,l,h,v,f=o(a("1da1")),g=o(a("5530")),m=(a("63af"),a("13b4")),b=a("26cb"),w=uni.getSystemInfoSync(),y=w.screenWidth,x=(w.pixelRatio,1),k=200,P=w.screenWidth,C={data:function(){return{imageSrc:"",isShowImg:!1,cropperInitW:y,cropperInitH:y,cropperW:y,cropperH:y,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:y,cutR:"100%",qualityWidth:P,innerAspectRadio:x}},computed:(0,g.default)({},(0,b.mapState)(["userInfo"])),onLoad:function(t){var e=t.tempFilePath;this.imageSrc=e},mounted:function(){this.loadImage()},methods:(0,g.default)((0,g.default)({},(0,b.mapMutations)(["setUserInfo"])),{},{setData:function(t){var e=this;Object.keys(t).forEach((function(a){e.$set(e.$data,a,t[a])}))},getImage:function(){var t=this;uni.chooseImage({success:function(e){t.setData({imageSrc:e.tempFilePaths[0]}),t.loadImage()}})},loadImage:function(){var t=this;uni.showLoading({title:"图片加载中..."}),uni.getImageInfo({src:t.imageSrc,success:function(e){l=e.width/e.height,l>=1?(h=y,v=y/l):(h=y*l,v=y);var a=h>v?h:v;if(k=a>k?k:a,l>=1){var o=Math.ceil((y/l-(y/l-k))/2),i=o,n=Math.ceil((y-y+k)/2),r=n;t.setData({cropperW:y,cropperH:y/l,cropperL:Math.ceil((y-y)/2),cropperT:Math.ceil((y-y/l)/2),cutL:n,cutT:o,cutR:r,cutB:i,imageW:h,imageH:v,scaleP:h/y,qualityWidth:P,innerAspectRadio:l})}else{var c=Math.ceil((y*l-y*l)/2),s=c,p=Math.ceil((y-k)/2),u=p;t.setData({cropperW:y*l,cropperH:y,cropperL:Math.ceil((y-y*l)/2),cropperT:Math.ceil((y-y)/2),cutL:c,cutT:p,cutR:s,cutB:u,imageW:h,imageH:v,scaleP:h/y,qualityWidth:P,innerAspectRadio:l})}t.setData({isShowImg:!0}),uni.hideLoading()}})},contentStartMove:function(t){i=t.touches[0].pageX,n=t.touches[0].pageY},contentMoveing:function(t){var e=(i-t.touches[0].pageX)*x,a=(n-t.touches[0].pageY)*x;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),a>0?this.cutT-a<0&&(a=this.cutT):this.cutB+a<0&&(a=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-a,cutR:this.cutR+e,cutB:this.cutB+a}),i=t.touches[0].pageX,n=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var t=this,e=this;uni.showLoading({title:"图片生成中..."});var a=uni.createCanvasContext("myCanvas");a.drawImage(e.imageSrc,0,0,h,v),a.draw(!0,(function(){var a=(e.cropperW-e.cutL-e.cutR)/e.cropperW*h,o=(e.cropperH-e.cutT-e.cutB)/e.cropperH*v,i=e.cutL/e.cropperW*h,n=e.cutT/e.cropperH*v;uni.canvasToTempFilePath({x:i,y:n,width:a,height:o,destWidth:a,destHeight:o,quality:.5,canvasId:"myCanvas",success:function(){var e=(0,f.default)(regeneratorRuntime.mark((function e(a){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=a.tempFilePath,uni.uploadFile({url:"http://122.9.14.73:8000/api/user/icon",filePath:o,name:"files",formData:{user:t.userInfo.id},success:function(e){var a=e.data;if(a){var o=t.userInfo;o.userpic=m.picUrl+a,t.setUserInfo(o)}uni.showToast({icon:"none",title:"提交成功",success:function(t){setTimeout((function(){uni.navigateBack({delta:1})}),2e3)}})}});case 2:case"end":return e.stop()}}),e)})));function a(t){return e.apply(this,arguments)}return a}()})}))},dragStart:function(t){r=t.touches[0].pageX,c=t.touches[0].pageY,s=this.cutL,u=this.cutR,d=this.cutB,p=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var a=(r-t.touches[0].pageX)*x;u+a<0&&(a=-u),this.setData({cutR:u+a});break;case"left":a=(r-t.touches[0].pageX)*x;s-a<0&&(a=s),s-a>this.cropperW-this.cutR&&(a=s-(this.cropperW-this.cutR)),this.setData({cutL:s-a});break;case"top":a=(c-t.touches[0].pageY)*x;p-a<0&&(a=p),p-a>this.cropperH-this.cutB&&(a=p-(this.cropperH-this.cutB)),this.setData({cutT:p-a});break;case"bottom":a=(c-t.touches[0].pageY)*x;d+a<0&&(a=-d),this.setData({cutB:d+a});break;case"rightBottom":var o=(r-t.touches[0].pageX)*x,i=(c-t.touches[0].pageY)*x;d+i<0&&(i=-d),u+o<0&&(o=-u);var n=d+i,l=u+o;this.setData({cutB:n,cutR:l});break;default:break}}})};e.default=C}}]);